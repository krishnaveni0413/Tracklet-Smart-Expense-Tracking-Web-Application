// Prisma Schema
generator client {
  provider = "prisma-client-js"
}

datasource db {
  provider = "postgresql"
  url      = env("DATABASE_URL")
}

enum TransactionType {
  expense
  income
}

model User {
  id                    String    @id @default(cuid())
  email                 String    @unique
  password              String
  name                  String
  createdAt             DateTime  @default(now())
  updatedAt             DateTime  @updatedAt
  
  // Relations
  expenses              Expense[]
  budgets               Budget[]
  savingsGoals          SavingsGoal[]
  settings              Settings?
}

model Expense {
  id                    String    @id @default(cuid())
  userId                String
  amount                Float
  category              String
  type                  TransactionType
  date                  DateTime
  note                  String?
  createdAt             DateTime  @default(now())
  updatedAt             DateTime  @updatedAt
  
  // Relations
  user                  User      @relation(fields: [userId], references: [id], onDelete: Cascade)
  
  @@index([userId])
  @@index([date])
}

model Budget {
  id                    String    @id @default(cuid())
  userId                String
  category              String
  limit                 Float
  createdAt             DateTime  @default(now())
  updatedAt             DateTime  @updatedAt
  
  // Relations
  user                  User      @relation(fields: [userId], references: [id], onDelete: Cascade)
  
  @@index([userId])
  @@unique([userId, category])
}

model SavingsGoal {
  id                    String    @id @default(cuid())
  userId                String
  name                  String
  targetAmount          Float
  currentAmount         Float    @default(0)
  deadline              DateTime
  createdAt             DateTime  @default(now())
  updatedAt             DateTime  @updatedAt
  
  // Relations
  user                  User      @relation(fields: [userId], references: [id], onDelete: Cascade)
  
  @@index([userId])
}

model Settings {
  id                    String    @id @default(cuid())
  userId                String    @unique
  currency              String    @default("USD")
  language              String    @default("en")
  theme                 String    @default("system")
  monthlyBudget         Float     @default(5000)
  aiInsights            Boolean   @default(true)
  appLock               Boolean   @default(false)
  hideSensitiveAmounts  Boolean   @default(false)
  timezone              String    @default("UTC")
  createdAt             DateTime  @default(now())
  updatedAt             DateTime  @updatedAt
  
  // Relations
  user                  User      @relation(fields: [userId], references: [id], onDelete: Cascade)
}
